using System;
using System.Collections.Generic;
using AAC_Game.Entities;

namespace AAC_Game.Core
{
    public class Map
    {

        //СВОЙСТВА
        public List<GameEntity> Entities { get; private set; }
        public int Width { get; private set; }
        public int Height { get; private set; }
        public int[,] Grid { get; private set; }

        //КОНСТРУКТОР
        public Map()
        {
            Entities = new List<GameEntity>();
        }

        //ЗАГРУЗКА УРОВНЕЙ 
        public void Load(int level)
        {
            switch (level)
            {
                case 1:
                    Grid = new int[,] {
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
                    };
                    break;

                case 2:
                    Grid = new int[,] {
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,0,1 },
                        { 1,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
                    };
                    break;

                case 3:
                    Grid = new int[,] {
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 },
                        { 1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1 },
                        { 1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1 },
                        { 1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1 },
                        { 1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1 },
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
                    };
                    break;

                case 4:
                    Grid = new int[,] {
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 },
                        { 1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1 },
                        { 1,0,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,1 },
                        { 1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1 },
                        { 1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1 },
                        { 1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1 },
                        { 1,0,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,0,1 },
                        { 1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1 },
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
                    };
                    break;

                case 5:
                    Grid = new int[,] {
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
                    };
                    break;

                default:
                    Grid = new int[,] {
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,1,1,0,0,0,0,1,1,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1 },
                        { 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 }
                    };
                    break;
            }

            Width = Grid.GetLength(1);
            Height = Grid.GetLength(0);
        }

        //УПРАВЛЕНИЕ СУЩНОСТЯМИ
        public void ClearEntities()
        {
            Entities.Clear();
        }
        public int GetEnemyCount()
        {
            int count = 0;
            foreach (var entity in Entities)
            {
                if (entity.IsEnemy)
                    count++;
            }
            return count;
        }

        //ПРОВЕРКА СТОЛКНОВЕНИЙ 
        public bool IsWall(int x, int y)
        {
            if (x < 0 || x >= Width || y < 0 || y >= Height)
                return true;
            return Grid[y, x] != 0;
        }

        public bool CanMoveTo(float x, float y)
        {
            int gridX = (int)x;
            int gridY = (int)y;
            return !IsWall(gridX, gridY);
        }
    }
}